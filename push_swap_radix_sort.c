/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   push_swap_middlesort.c                             :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: stena-he <stena-he@student.42wolfsburg.de> +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2022/06/12 22:27:25 by tfedoren          #+#    #+#             */
/*   Updated: 2022/06/16 12:09:06 by stena-he         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "push_swap.h"

t_stack	*ft_lstlast_push_swap(t_stack *lst)
{
	if (!lst)
		return (NULL);
	while (lst->next)
		lst = lst->next;
	return (lst);
}

void	sorting_array_of_ints(int *arr, int max)
{
	int	i;
	int	temp;

	i = 0;
	while (i < max)
	{
		i++;
		if (arr[i] < arr[i - 1])
		{
			temp = arr[i];
			arr[i] = arr[i - 1];
			arr[i - 1] = temp;
			i = 0;
		}
	}
}

int	indexing_helper(int *arr, int data, int max)
{
	int	i;

	i = 0;
	while (i < max)
	{
		if (data == arr[i])
			return (i);
		i++;
	}
//	i++;
//	ft_printf("i %d\n", i);
	return (i);
}

void	indexing(t_stack **stack, int max)
{
	t_stack	*temp;
	int		*temp_int;
	int		*arr;
	int		i;

	
	i = 0;
	arr = malloc(sizeof(int) * max);
	temp = *stack;
	while (temp)
	{
		arr[i] = temp->data;
		i++;
		temp = temp->next;
	}
	
	sorting_array_of_ints(arr, max);
	temp = *stack;
	while(temp)
	{
		temp_int = &(temp->index);
		//ft_printf("temp->index %d\n", temp->index);
		*temp_int = indexing_helper(arr, temp->data, max);
		//ft_printf("indexing_helper(arr, temp->index, max) %d\n", indexing_helper(arr, temp->index, max));
		temp = temp->next;
		//ft_printf("Stack a11111: ");
		// print_stack(*stack);
		// ft_printf("\n");
		// ft_printf("Stack a index 11111: ");
		// print_stack_index(*stack);
		//  ft_printf("\n");
	}
	free(arr);
}

int	sorting(t_stack **stack_a, t_stack **stack_b)
{
	int max_bits;
	int i;
	int	count;
	int j;
	int size;

	count = 0;
	//j=0;
	size = ft_stack_size(*stack_a);
	max_bits = 0;
	i = 0;

	//j = 0;
	while (((ft_stack_size(*stack_a) -1) >> max_bits) != 0)
		++max_bits;
	//ft_printf("max_bits %d\n", max_bits);

	while (i < max_bits && check_if_sorted(stack_a))
	//while (i < max_bits && check_if_sorted(stack_a))
	{
				//ft_printf("i3 %d\n", i);
			j = 0;
		while(j < size)
		{
			//ft_printf("i2 %d\n", i);
			//ft_printf("j %d\n", j);
			//ft_printf("((*stack_a)->index) %d\n", ((*stack_a)->index));
			if (((((*stack_a)->index) >> i) & 1) == 1)
			{
				ra(stack_a);
				count++;
			}
			else 
			{
				pb(stack_b, stack_a);				
				count++;
			}

			j++;
			//ft_printf("j %d\n", j);
		}
	
		//j = 0;
		while (!is_empty(*stack_b))
		{
			pa(stack_a, stack_b);
			count++;
		}
		i++;
	}
	return (count);
}

	
		//*********************************************************
		// while (ft_stack_size(*stack_a) > 3)
		// {
		// 		if((*stack_a)->data == find_min(*stack_a))
		// 		{
		// 			pb(stack_b, stack_a);
		// 			count++;
		// 		}
		// 		else
		// 		{
		// 			ra(stack_a);
		// 			count++;
		// 		}
		// }
		//*********************************************************
//100 92 40 96 59 9 60 79 87 65 35 98 83 17 14 52 78 85 71 43 15 41 82 11 88 58 81 56 -6 19 24 90 -10 47 4 26 80 27 54 48 1 13 -8 29 -1 22 74 6 12 20 73 66 68 69 37 31 34 2 30 -7 46 55 61 67 33 91 70 63 50 10 53 84 7 -4 25 32 39 38 28 64 93 21 97 76 -5 62 0 23 -9 5 72 86 57 95 44 3 18 89 42 77

//705 -37 519 330 855 110 988 229 801 390 -66 294 691 -40 942 208 793 978 393 867 955 62 337 76 382 497 933 104 460 704 415 896 365 107 69 964 914 9 -10 842 903 760 -91 679 273 805 75 376 407 201 58 898 186 478 206 427 823 81 16 321 762 -45 92 239 4 789 461 711 706 667 721 211 349 575 533 683 655 21 957 754 114 815 662 513 868 522 541 718 473 853 38 744 367 939 355 214 592 881 841 432


//302 118 233 112 225 435 390 918 276 185 367 86 -81 7 525 970 197 523 621 949 965 98 602 235 527 46 543 483 252 897 227 917 516 21 137 677 307 993 494 612 816 -74 787 584 -21 -98 936 678 867 246 339 660 128 634 994 213 282 341 697 433 170 830 915 547 566 109 713 376 503 430 20 670 490 599 631 707 577 947 51 812 923 728 768 -37 451 -59 890 836 592 626 57 696 -56 223 155 828 979 87 114 750 715 749 589 609 316 701 186 784 853 722 588 190 761 593 855 295 672 397 700 251 611 601 755 66 -40 312 977 729 450 -6 408 90 123 988 241 871 827 706 997 859 173 311 324 318 -12 25 571 479 532 651 103 -15 222 466 590 478 759 -84 356 383 975 727 664 247 -61 364 -76 457 243 643 642 405 742 138 5 -22 -20 352 290 558 942 342 767 480 319 402 445 245 674 633 497 254 404 508 267 919 968 321 825 765 34 464 705 -35 939 931 294 896 748 100 820 381 271 570 981 519 502 49 658 41 132 441 113 372 606 852 18 -69 740 320 -54 64 892 951 474 807 69 88 489 328 177 77 32 411 899 817 941 957 647 837 72 331 582 437 467 724 -5 399 382 991 36 791 -33 776 10 355 48 505 323 841 -45 297 453 492 249 838 486 278 995 -11 839 374 561 676 327 55 557 883 718 140 641 687 427 684 655 389 326 91 600 645 568 591 403 -58 586 182 821 980 533 875 258 771 377 410 927 580 -10 563 974 53 845 406 579 368 421 187 452 876 144 910 482 829 346 17 607 262 -2 131 733 84 371 -42 260 443 -38 986 463 -67 426 819 738 362 487 953 256 317 -43 832 212 835 539 894 -41 691 847 115 148 161 19 485 335 -48 639 794 695 -9 916 133 614 15 -3 26 926 181 870 902 818 171 6 709 719 462 288 575 229 -89 62 455 559 -13 -63 773 565 80 59 802 663 107 119 958 168 11 689 -96 305 336 308 52 343 665 -28 512 704 648 360 556 809 996 769 -50 165 -97 370 117 891 789 160 624 174 -23 840 912 210 734 963 662 45 683 422 721 159 623 472 -24 652 -86 347 743 -73 163 514 228 803 418 851 76 167 484 595 94 537 365 685 27 702 253 242 70 698 933 175 434 238 -70 9 596 -60 416 -8 920 277 300 615 129 983 -100 901 28 157 378